<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<ui:composition
	template="/WEB-INF/templates/layout4/basicTemplate.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:cc="http://java.sun.com/jsf/composite/components">


	<ui:define name="title">Contas a Pagar</ui:define>

	<ui:define name="content">

		<style type="text/css">	
/* 				.ui-datatable .ui-row-toggler {  */
			
/* 				} */
/* 				.table-color{ */
/* 					background: none repeat scroll 0 0 #FF66FF !important; */
/* 				} */
/* 					.table-color-teste{ */
/* 					font-size:11px */
/* 				} */
		</style>

		<div class="page-content-wrapper">
			<div class="page-content">
				<div class="col-md-12">
					<div style="margin-top:-9px !important" class="portlet box red">
						<div class="portlet-title">
							<div class="caption"><i class="icon-calculator"></i>Consulta Contas a Pagar</div>
						</div>
						<div class="portlet-body">
							<div class="table-toolbar">
								<h:form id="form">
									<div class="row">
										<div class="col-md-6">
											<div class="col-md-5">
												<h:outputLabel class="control-label-custom"
													value="Data Prev. Pagamento" />
											</div>
											<div class="col-md-7">
												<p:calendar showButtonPanel="false" pattern="dd/MM/yyyy" styleClass="form-control-calendar" 
													showOn="button" locale="pt_BR" size="6"
													value="#{contasPagar.filter.filter.dataPrevistaInicio}" mask="true">  
												</p:calendar>
												<h:outputLabel class="control-label-custom" value="à" style="padding:0px 10px;" />
												<p:calendar styleClass="form-control-calendar" pattern="dd/MM/yyyy"
													showOn="button" locale="pt_BR" size="6"
													value="#{contasPagar.filter.filter.dataPrevistaFinal}" mask="true">
												</p:calendar>
											</div>
										</div>
										<div class="col-md-6">
											<div class="col-md-5">
												<h:outputLabel class="control-label-custom" value="Data Vencimento" />
											</div> 
											<div class="col-md-7">
												<p:calendar styleClass="form-control-calendar" pattern="dd/MM/yyyy" showOn="button" locale="pt_BR"
													size="6" value="#{contasPagar.filter.filter.dataVencimentoInicio}" mask="true">
												</p:calendar>
												<h:outputLabel class="control-label-custom" value="à"
												style="padding:0px 10px" />
												<p:calendar styleClass="form-control-calendar" pattern="dd/MM/yyyy" showOn="button" locale="pt_BR" size="6"
													value="#{contasPagar.filter.filter.dataVencimentoFim}" mask="true">
												</p:calendar>
											</div>
										</div>
										
										
									</div>
									
									<div style="padding: 5px 0px" class="row" />

									<div class="row">
									
										<div class="col-md-6">
											<div class="col-md-5">
												<h:outputLabel class="control-label-custom" value="Sacado" />
											</div>
											<div class="col-md-7">
												<h:selectOneMenu  class="form-control form-control-combo-custom" id="empresa" converter="entityConverter"
													value="#{contasPagar.filter.filter.empresa}">
													<f:selectItem itemLabel="Selecione" noSelectionOption="true" />
													<f:selectItems value="#{contasPagar.empresaList}" var="empresa"
														itemLabel="#{empresa.descricao}" />
												</h:selectOneMenu>
											</div>
										</div>
										
										<div class="col-md-6">
											<div class="col-md-5">
												<h:outputLabel class="control-label-custom" value="Fornecedor" />
											</div>
											<div class="col-md-7">
												<h:selectOneMenu  class="form-control form-control-combo-custom" id="fornecedor" converter="entityConverter"
													value="#{contasPagar.filter.filter.fornecedor}">
													<f:selectItem itemLabel="Selecione" noSelectionOption="true" />
													<f:selectItems value="#{contasPagar.fornecedorList}"
														var="fornecedor" itemLabel="#{fornecedor.descricao}" />
												</h:selectOneMenu>
											</div>
										</div>
									</div>
									
									<div style="padding: 5px 0px" class="row" />

									<div class="row">
									
										<div class="col-md-6">
											<div class="col-md-5">
												<h:outputLabel class="control-label-custom" value="Descrição" />
											</div>
											<div class="col-md-7">
												<h:inputText maxlength="300" class="form-control form-control-custom" value="#{contasPagar.filter.filter.descricao}" />
											</div>
										</div>
										
										<div class="col-md-6">
											<div class="col-md-5">
												<h:outputLabel class="control-label-custom" value="Conta" />
											</div>
											<div class="col-md-7">
												<h:selectOneMenu  class="form-control form-control-combo-custom" id="contas" converter="entityConverter"
													value="#{contasPagar.filter.filter.conta}">
													<f:selectItem style="margin-top:0px;" itemLabel="Selecione" itemValue="" />
													<f:selectItems value="#{contasPagar.listaContas}" />
												</h:selectOneMenu>
											</div>
										</div>
									</div>
									
									<div style="padding: 5px 0px" class="row" />

									<div class="row">
									
										<div class="col-md-6">
											<div class="col-md-5">
												<h:outputLabel  class="control-label-custom"  value="Valor" />
											</div>
											<div class="col-md-7" style="display: -webkit-inline-box !important;">
												<p:inputText  class="form-control form-control-custom" maxlength="8" style="width:113px" value="#{contasPagar.filter.filter.valorInicial}">
													<f:convertNumber type="number" pattern="#,##0.00" />
												</p:inputText> 
												
												<h:outputLabel styleClass="control-label-custom" value="à" style="padding:0px 10px" />
											
												<p:inputText class="form-control form-control-custom" maxlength="8" style="width:113px" value="#{contasPagar.filter.filter.valorFinal}">
												  	<f:convertNumber type="number" pattern="#,##0.00" />
												</p:inputText>
											</div>
										</div>
										
										<div class="col-md-6">
											
										</div>
										
									</div>
									
									<div class="row">
										<div class="col-md-12" >
											<div style="padding: 0px 30px;float:right">
												<p:commandButton value="Pesquisar" action="#{contasPagar.carregaContasPagar()}" update="tableContasPagar" ajax="false" process="@form" />
												<p:commandButton value="Limpar" ajax="false" process="@form" update="form" action="#{contasPagar.filter.limpaFiltro()}" />
											</div>
										</div>
									</div>
									
									<p:separator />
									
									<div class="row">
										<div class="col-md-12" >
											<div id="grid">
												<p:button  value="Novo" outcome="contasPagar" />
												<div style="padding: 5px 0px" class="row" />
												
												<p:dataTable var="contaAPagartblOne" value="#{contasPagar.contasPagarList()}" id="tableContasPagar"
													paginator="true" rows="#{contasPagar.nroRegistrosPorPagina}" paginatorPosition="bottom"
													rowsPerPageTemplate="#{contasPagar.opcoesRegistrosPorPagina}" lazy="true"
													emptyMessage="#{contasPagar.nenhumRegistroEncontrado}">
													
														 <p:column style="width:30px">
												           	<p:rowToggler />
													     </p:column>
													     <p:column>
													     	<h:outputText value="#{contaAPagartblOne.dataVencimento}" />
													     </p:column>
													     
													     <p:rowExpansion>
												            <p:dataTable id="dois" var="contaAPagar" value="#{contaAPagartblOne.contaPagarList}">
														      
														     	<p:column style="width:5%; text-align:center">
																	<p:button  icon="ui-icon-pencil"   outcome="contasPagar">
																		<f:param name="id"  value="#{contaAPagar.id}"></f:param>
																	</p:button>
																</p:column>
																
																<p:column style="width:5%; text-align:center">
																	<p:commandButton icon="ui-icon-close" actionListener="#{contasPagar.excluir(contaAPagar)}" update=":form:tableContasPagar:dois" process="@form">
																		<p:confirm header="Confirmar Exclusão" message="Deseja Excluir o Registro?" icon="ui-icon-alert" />
																	</p:commandButton>
																</p:column>
																
																<p:column style="width:5%; text-align:center">
																	<p:commandButton  icon="ui-icon-document" action="#{contasPagar.carregaRateios()}"  update=":tableRateioPorRegistro" 
																		oncomplete="PF('dialogRateios').show();"  >
																		<f:setPropertyActionListener target="#{contasPagar.contaPagarSel}"  value="#{contaAPagar}" />
																	</p:commandButton>
																</p:column>
						
																<p:column style="width:20%">
																	<f:facet name="header">
																		<h:outputText  value="Descrição" />
																	</f:facet>
																	<h:outputText value="#{contaAPagar.descricao}" />
																</p:column>
									
																<p:column style="width:10%; text-align:right">
																	<f:facet name="header">
																		<h:outputText value="Valor Total" />
																	</f:facet>
																	<h:outputText value="#{contaAPagar.valor}">
																		<f:convertNumber minFractionDigits="2" />
																	</h:outputText>
																</p:column>
									
																<p:column>
																	<f:facet name="header">
																		<h:outputText value="Conta" />
																	</f:facet>
																	<h:outputText value="#{contaAPagar.conta.descricao}" />
																</p:column>
									
																<p:column>
																	<f:facet name="header">
																		<h:outputText value="Fornecedor" />
																	</f:facet>
																	<h:outputText value="#{contaAPagar.fornecedor.descricao}" />
																</p:column>
									
																<p:column>
																	<f:facet name="header">
																		<h:outputText value="Sacado" />
																	</f:facet>
																	<h:outputText value="#{contaAPagar.empresa.descricao}" />
																</p:column>
									
																<p:column style="width:11%; text-align:center">
																	<f:facet name="header">
																		<h:outputText value="Dt Prev. Pgto" />
																	</f:facet>
																	<h:outputText value="#{contaAPagar.dataPrevista}">
																		<f:convertDateTime locale="pt-BR" pattern="dd/MM/yyyy" />
																	</h:outputText>
																</p:column>
									
																<p:column style="width:9%; text-align:center">
																	<f:facet name="header">
																		<h:outputText value="Dt Pgto" />
																	</f:facet>
																	<h:outputText value="#{contaAPagar.dataVencimento}">
																		<f:convertDateTime locale="pt-BR" pattern="dd/MM/yyyy" />
																	</h:outputText>
																</p:column>
															</p:dataTable>
												        </p:rowExpansion>
						
												</p:dataTable>
						
											</div>
										</div>
									</div>
									
								</h:form>

							</div>
						</div>
					</div>
					<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">  
						<p:commandButton value="Sim" update=":form:tableContasPagar:dois" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check"/>
						<p:commandButton value="Não" update=":form:tableContasPagar:dois" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close"/>
					</p:confirmDialog>
					<p:dialog resizable="false" header="Lançamentos" widgetVar="dialogRateios" id="dialogRateios" modal="true" height="300" width="800">
				
							<p:dataTable var="rat" value="#{contasPagar.rateioEmpresaList}" id="tableRateioPorRegistro"
								paginator="true" rows="#{contasPagar.nroRegistrosPorPagina}" paginatorPosition="bottom"
								rowsPerPageTemplate="#{contasPagar.opcoesRegistrosPorPagina}" lazy="true"
								emptyMessage="#{contasPagar.nenhumRegistroEncontrado}">
								
								<p:column width="50">
									<f:facet name="header">
										<h:outputText value="Empresa" />
									</f:facet>
									<h:outputText value="#{rat.empresa.descricao}" />
								</p:column>
								
								<p:column width="20">
									<f:facet name="header">
										<h:outputText value="Valor" />
									</f:facet>
									<h:outputText value="#{rat.valor}" >
											<f:convertNumber pattern="#,##0.00"></f:convertNumber>
									</h:outputText>
								</p:column>
								
								
						</p:dataTable>
							
						<f:facet name="footer">
								<p:commandButton style="float:right;margin-bottom:10px;height:38px"  value="Fechar" onclick="PF('dialogRateios').hide();" icon="ui-icon-circle-close"  />
						</f:facet>
					</p:dialog>
				</div>
			</div>
		</div>

	</ui:define>
</ui:composition>