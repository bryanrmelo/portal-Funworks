<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<title>Portal - Minhas Mensalidades</title>
	<link rel="icon" href="../resources/imagens/fun-icon.png" />
	<link rel="stylesheet" href="../resources/css/mensalidadeStyle.css" />
</h:head>
<h:body>
	<ui:insert name="template">
		<ui:include src="/resources/templates/headers.xhtml" />
		<p:messages id="messages" showDetail="false" closable="true" />
		<div class="container-fluid cor-gradiente borda">
			<div>
				<h2 class="text-white m-0 p-3">
					<h:outputText
						value="Minhas Mensalidades > #{mensalidadeBack.nomeCompleto()}" />
				</h2>
			</div>
		</div>

		<h:form class="mt-3">
			<p:dataTable id="mensalidades" var="mensalidade"
				value="#{mensalidadeBack.listaMensalidades}" rowIndexVar="index"
				editable="true" editMode="cell" update=":form:msgs"
				widgetVar="uploadDialog" sortMode="single">
				<p:ajax event="cellEdit"
					listener="#{mensalidadeBack.listenerObservacaoEdit}" />

				<p:column headerText="ASSOCIADO(A)" style="width: 15%;">
					<h:outputText
						value="#{mensalidadeBack.nomeCompleto(mensalidade.usuario.login)}" />
				</p:column>

				<p:column headerText="VALOR" style="width: 5%;">
					<h:outputText
						value="R$ #{mensalidadeBack.valorFormatado(mensalidade.valor)}" />
				</p:column>

				<p:column headerText="VENCIMENTO" style="width: 13%;"
					sortBy="#{mensalidade.dataVencimento}" sortOrder="asc">
					<h:outputText
						value="#{mensalidadeBack.dataFormatada(mensalidade.dataVencimento)}" />
				</p:column>

				<p:column headerText="COMPROVANTE" style="width: 17%;">
					<h:outputText
						value="#{mensalidadeBack.mostrarNomeComprovante(mensalidade)}" />

					<p:commandButton styleClass="float-end"
						actionListener="#{mensalidadeBack.abrirModal(index)}"
						icon="fa fa-fw fa-plus-circle" />

					<p:commandButton ajax="false" styleClass="float-end"
						actionListener="#{mensalidadeBack.downloadComprovante(mensalidade)}"
						icon="fa fa-fw fa-download"
						disabled="#{mensalidade.comprovante eq null}">
						<p:fileDownload value="#{mensalidadeBack.comprovanteDownload}" />
					</p:commandButton>
				</p:column>

				<p:column headerText="OBSERVAÇÃO" style="width: 20%;">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{mensalidade.observacao}"
								style="word-wrap: break-word;" />
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{mensalidade.observacao}"
								style="width: 100%;" label="Observacao" />
						</f:facet>
					</p:cellEditor>
					<i class="far fa-edit float-end"></i>
				</p:column>

				<p:column headerText="STATUS" style="width: 10%;"
					sortBy="#{mensalidade.pagamento}" sortOrder="asc">
					<h:graphicImage
						value="data:image/png;base64,#{mensalidadeBack.mostrarImagemPagamento(mensalidade.pagamento)}"
						style="max-width: 13px; max-height: 13px; text-align: center;" />
				</p:column>
			</p:dataTable>
		</h:form>

		<p:dialog
			style="margin-bottom: 200px; position: fixed; bottom: 10; max-height: 200px; max-width: 400px;"
			header="Upload" widgetVar="uploadDialog" responsive="true"
			closable="true" resizable="false" showEffect="fade" hideEffect="fade"
			modal="true" width="70%">
			<h:form class="p-3 mb-0" enctype="multipart/form-data"
				acceptcharset="UTF-8">
				<div class="flex-fill col-2">
					<p:fileUpload mode="simple" skinSimple="true"
						label="Carregar imagem" value="#{mensalidadeBack.comprovante}"
						accept="application/pdf" />
					<h:commandButton styleClass="mt-3" type="submit" value="Enviar"
						actionListener="#{mensalidadeBack.salvarComprovante()}"></h:commandButton>
				</div>
			</h:form>
		</p:dialog>

		<div class="importante-box">
			<div class="importante-box-header">
				<h5 class="text-white m-0 p-2">
					<b>IMPORTANTE</b>
				</h5>
			</div>
			<div class="p-2">
				<p>Prezado(a),</p>
				<p>Pedimos que ao realizar o pagamento das mensalidades
					Funworks, utilize somente os dados abaixo:</p>
				<p>Chave PIX: funworks@keyworks.com.br</p>
				<p>(O comprovante de pagamento dever ser anexado em formato
					PDF.)</p>
				<p class="m-0">Caso alguém não possua PIX, segue conta para a
					transferência:</p>
				<p class="m-0">Banco: Nu Pagamentos S.A (260) - Agência: 0001 -
					Conta Corrrente: 6617159-3</p>
				<p class="m-0">Cássio Luciano Colussi - CPF: 897.819.610-15</p>
				<p>Após a confirmação do pagamento, o status será atualizado.</p>
				<p>A Funworks Agradece!</p>
			</div>
		</div>
	</ui:insert>
</h:body>
</html>
